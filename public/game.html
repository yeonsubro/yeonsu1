<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pachinko</title>
    <style>
        body {
            background-color: #282c34;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        #box {
            border: 5px solid navy;
            width: 300px;
            height: 300px;
            position: relative;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .row {
            display: flex;
            justify-content: space-between;
        }
        .cellBox {
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2em; /* í°íŠ¸ í¬ê¸° ì¡°ì • */
            background-color: rgba(255, 255, 255, 0.8);
            border: 1px solid black;
        }
        .cellBox.jackpot {
            background-color: gold; /* ì­íŒŸì¼ ë•Œ ë°°ê²½ìƒ‰ */
        }
        .cellBox.win {
            background-color: lightgreen; /* ë‹¹ì²¨ì¼ ë•Œ ë°°ê²½ìƒ‰ */
        }
        #status {
            margin-top: 10px;
        }
        #betInput {
            width: 60px;
        }
        #result {
            margin-top: 10px;
            color: white;
        }
    </style>
</head>
<body>

    <h1>ë¹ ì°¡ê¼¬ë˜~ë¹ ì§•ë¹ ì°¡ê¼¬ë˜~</h1>
    <button id="startBtn">START Button</button>
    <button id="stopBtn">STOP ALL</button>
    <hr>
    <div class="buttonContainer">
        <button id="backBtn">í™ˆí˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</button>
    </div>
    <div class="stopButtons">
        <button class="stopColBtn" data-col="0">STOP 1</button>
        <button class="stopColBtn" data-col="1">STOP 2</button>
        <button class="stopColBtn" data-col="2">STOP 3</button>
    </div>
    <div id="box"></div>
    <div id="status">
        <p>í˜„ì¬ ê¸ˆì•¡: <span id="balance">10000</span>ì›</p>
        <p>
            ë°°íŒ… ê¸ˆì•¡: <input type="number" id="betInput" min="1000" step="1000" value="1000">ì›
            <button id="betBtn">BET</button>
        </p>
    </div>
    <div id="result"></div>

<script>
    document.getElementById("backBtn").addEventListener("click", function() {
    window.location.href = "https://yeonsu0512.web.app/index.html"; // ì—¬ê¸°ì— ì´ë™í•  URLì„ ì…ë ¥í•˜ì„¸ìš”
});
    let balance = 10000;
let betAmount = 1000;
let isBetPlaced = false;
let stoppedCols = [false, false, false];
let totalStopped = 0;
let isStarted = false; // ì‹œì‘ ìƒíƒœ ì¶”ì  ë³€ìˆ˜ ì¶”ê°€

function Box() { }
Box.prototype.init = function() {
    this.cellBox = document.createElement("div");
    this.cellBox.setAttribute("class", "cellBox");
    this.elementLi = document.createElement("div");
    this.elementLi.innerText = 'ğŸ’'; // ê¸°ë³¸ê°’ ğŸ’ (ì²´ë¦¬)
    this.cellBox.appendChild(this.elementLi);
    return this.cellBox;
}

Box.prototype.start = function(speed) {
    this.y = 0;
    this.intervalRef = setInterval(() => {
        this.y -= 10;
        this.elementLi.innerText = getRandomEmoji(); // ëœë¤ ì´ëª¨ì§€ í˜¸ì¶œ
        if (this.y <= -900) {
            this.y = 0;
        }
    }, speed);
}

function getRandomEmoji() {
    const emojis = ['ğŸ’', 'ğŸ‹', 'ğŸŠ', 'ğŸ‡', 'ğŸ‰', 'â­', 'ğŸ””', '7ï¸âƒ£', 'ğŸ°'];
    return emojis[Math.floor(Math.random() * emojis.length)];
}

Box.prototype.stop = function() {
    clearInterval(this.intervalRef);
    const emojiIndex = Math.floor(Math.abs(this.y) / 100) % 5; // ì´ëª¨ì§€ ì¸ë±ìŠ¤
    this.elementLi.innerText = getRandomEmoji(); // ì •ì§€ ì‹œ ë³´ì—¬ì¤„ ì´ëª¨ì§€
}

function checkResults() {
    const rows = 3;
    const cols = 3;
    const results = [];
    let isJackpot = false;

    for (let i = 0; i < rows; i++) {
        const rowResult = [];
        for (let j = 0; j < cols; j++) {
            const index = i * cols + j;
            const emoji = boxArr[index].elementLi.innerText;
            rowResult.push(emoji);
            boxArr[index].cellBox.classList.remove('jackpot', 'win'); // ê¸°ì¡´ í´ë˜ìŠ¤ ì œê±°
            if (emoji === '7ï¸âƒ£') {
                boxArr[index].cellBox.classList.add('jackpot'); // ì­íŒŸ í´ë˜ìŠ¤ ì¶”ê°€
            }
        }
        results.push(rowResult);
    }

    isJackpot = results.some(row => row.join('') === '7ï¸âƒ£7ï¸âƒ£7ï¸âƒ£');
    let win = false;

    // ì­íŒŸ í™•ì¸
    if (isJackpot) {
        balance += betAmount * 10; // ì­íŒŸ ì‹œ ë°°íŒ… ê¸ˆì•¡ì˜ 10ë°° ì¶”ê°€
        document.getElementById("result").innerText = "ì­íŒŸì…ë‹ˆë‹¤! í˜„ì¬ ê¸ˆì•¡: " + balance + "ì›";
        return;
    }

    // ë‹¹ì²¨ ì—¬ë¶€ í™•ì¸
    for (let i = 0; i < rows; i++) {
        if (results[i][0] === results[i][1] && results[i][1] === results[i][2]) {
            win = true;
            for (let j = 0; j < cols; j++) {
                boxArr[i * cols + j].cellBox.classList.add('win'); // ë‹¹ì²¨ í´ë˜ìŠ¤ ì¶”ê°€
            }
        }
    }

    for (let i = 0; i < cols; i++) {
        if (results[0][i] === results[1][i] && results[1][i] === results[2][i]) {
            win = true;
            for (let j = 0; j < rows; j++) {
                boxArr[j * cols + i].cellBox.classList.add('win'); // ë‹¹ì²¨ í´ë˜ìŠ¤ ì¶”ê°€
            }
        }
    }

    if (results[0][0] === results[1][1] && results[1][1] === results[2][2]) {
        win = true;
        boxArr[0].cellBox.classList.add('win'); // ëŒ€ê°ì„  ë‹¹ì²¨
        boxArr[4].cellBox.classList.add('win'); // ëŒ€ê°ì„  ë‹¹ì²¨
        boxArr[8].cellBox.classList.add('win'); // ëŒ€ê°ì„  ë‹¹ì²¨
    }

    if (results[0][2] === results[1][1] && results[1][1] === results[2][0]) {
        win = true;
        boxArr[2].cellBox.classList.add('win'); // ëŒ€ê°ì„  ë‹¹ì²¨
        boxArr[4].cellBox.classList.add('win'); // ëŒ€ê°ì„  ë‹¹ì²¨
        boxArr[6].cellBox.classList.add('win'); // ëŒ€ê°ì„  ë‹¹ì²¨
    }

    // ë‹¹ì²¨ ì—¬ë¶€ì— ë”°ë¼ ê²°ê³¼ í‘œì‹œ
    if (win) {
        balance += betAmount * 2; // ë‹¹ì²¨ ì‹œ ë°°íŒ… ê¸ˆì•¡ì˜ 2ë°° ì¶”ê°€
        document.getElementById("result").innerText = "ë‹¹ì²¨ì…ë‹ˆë‹¤! í˜„ì¬ ê¸ˆì•¡: " + balance + "ì›";
    } else {
        balance -= betAmount; // ë¯¸ë‹¹ì²¨ ì‹œ ë°°íŒ… ê¸ˆì•¡ ì°¨ê°
        document.getElementById("result").innerText = "ê½ì…ë‹ˆë‹¤! í˜„ì¬ ê¸ˆì•¡: " + balance + "ì›";
    }

    document.getElementById("balance").innerText = balance;
}

const divBox = document.querySelector("#box");
const boxArr = [];
const rows = 3; 
const cols = 3; 

for (let i = 0; i < rows; i++) {
    const rowDiv = document.createElement("div");
    rowDiv.setAttribute("class", "row");
    for (let j = 0; j < cols; j++) {
        const box = new Box();
        boxArr.push(box);
        const newBox = box.init();
        rowDiv.appendChild(newBox);
    }
    divBox.appendChild(rowDiv);
}

const startBtn = document.querySelector("#startBtn");
const stopBtn = document.querySelector("#stopBtn");
const stopColBtns = document.querySelectorAll(".stopColBtn");

startBtn.addEventListener('click', function (event) {
    if (!isBetPlaced) {
        alert("ë°°íŒ…ì„ ë¨¼ì € í•´ì£¼ì„¸ìš”.");
        return;
    }
    totalStopped = 0;
    stoppedCols = [false, false, false];
    isStarted = true; // ì‹œì‘ ë²„íŠ¼ í´ë¦­ ì‹œ ìƒíƒœ ì—…ë°ì´íŠ¸
    boxArr.forEach(function (box) {
        box.start(Math.floor(5 + Math.random() * 20));
    });
});

stopBtn.addEventListener('click', function (event) {
    if (!isStarted) {
        alert("ë¨¼ì € START ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.");
        return;
    }
    if (!isBetPlaced) {
        alert("ë°°íŒ…ì„ ë¨¼ì € í•´ì£¼ì„¸ìš”.");
        return;
    }
    boxArr.forEach(function (box) {
        box.stop();
    });
    totalStopped = 3;
    checkResults();
});

stopColBtns.forEach(button => {
    button.addEventListener('click', function () {
        if (!isStarted) {
            alert("ë¨¼ì € START ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.");
            return;
        }
        if (!isBetPlaced) {
            alert("ë°°íŒ…ì„ ë¨¼ì € í•´ì£¼ì„¸ìš”.");
            return;
        }
        const col = parseInt(this.getAttribute("data-col"));
        if (stoppedCols[col]) return; // ì´ë¯¸ ë©ˆì¶˜ ìŠ¬ë¡¯ì€ ë¬´ì‹œ
        stoppedCols[col] = true; // í•´ë‹¹ ì—´ ë©ˆì¶¤ ìƒíƒœ ì—…ë°ì´íŠ¸

        for (let i = col; i < boxArr.length; i += cols) {
            boxArr[i].stop(); // í•´ë‹¹ ì—´ì˜ ìŠ¬ë¡¯ ë©ˆì¶”ê¸°
        }

        totalStopped++;
        if (totalStopped === 3) {
            checkResults(); // ê²°ê³¼ ì²´í¬
        }
    });
});

document.getElementById("betBtn").addEventListener('click', function () {
    betAmount = parseInt(document.getElementById("betInput").value);
    if (betAmount > balance) {
        alert("ë°°íŒ… ê¸ˆì•¡ì´ í˜„ì¬ ê¸ˆì•¡ë³´ë‹¤ ë§ìŠµë‹ˆë‹¤.");
        return;
    }
    balance -= betAmount; // ë°°íŒ… ì‹œ ê¸ˆì•¡ ì°¨ê°
    isBetPlaced = true;
    document.getElementById("result").innerText = "ë°°íŒ… ê¸ˆì•¡: " + betAmount + "ì›";
    document.getElementById("balance").innerText = balance; // í˜„ì¬ ê¸ˆì•¡ ì—…ë°ì´íŠ¸
});
</script>
</body>
</html>
